---
format: hypermake.v0

name: zupi
description: Robot project putting Raspberry Pi on Zumo

targets:
  toolchain:
    description: build zupi toolchain
    watches:
      - hack/toolchain
    build: hack/toolchain

  exec:
    description: environment for hmake -x
    after:
      - toolchain

  root:
    description: environment for hmake -x with root privilege
    after:
      - toolchain
    user: root

  deps:
    description: install dependencies
    after:
      - 'deps-*'

  generate:
    description: generate code
    after:
      - 'gen-*'

  build:
    description: build components
    after:
      - 'build-*'

  pack:
    description: package artifacts
    after:
      - 'pack-*'

  clean:
    description: clean intermediate files
    after:
      - 'clean-*'

includes:
  - '**/**/*.hmake'

settings:
  exec-target: exec
  exec-shell: /bin/bash
  docker:
    image: zupi-toolchain:latest
    src-volume: /go/src/github.com/evo-bots/zupi
